<% layout("/layouts/boilerplate") %>

<div class="admin-dashboard">
  <h2 class="mb-4">Admin Dashboard</h2>

  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card bg-primary text-white">
        <div class="card-body">
          <h5 class="card-title">Total Bookings</h5>
          <h2 class="card-text"><%= bookingsCount %></h2>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card bg-success text-white">
        <div class="card-body">
          <h5 class="card-title">Total Pujas</h5>
          <h2 class="card-text"><%= pujasCount %></h2>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card bg-info text-white">
        <div class="card-body">
          <h5 class="card-title">Total Users</h5>
          <h2 class="card-text"><%= usersCount %></h2>
        </div>
      </div>
    </div>
  </div>

  <div class="recent-bookings">
    <h3 class="mb-3">Recent Bookings</h3>
    <div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th>Booking ID</th>
            <th>User</th>
            <th>Puja</th>
            <th>Date</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% recentBookings.forEach(booking => { %>
          <tr>
            <td><%= booking._id %></td>
            <td><%= booking.user.name %></td>
            <td><%= booking.puja.title %></td>
            <td><%= booking.date.toLocaleDateString() %></td>
            <td>
              <span
                class="badge bg-<%= booking.status === 'confirmed' ? 'success' : 'warning' %>"
              >
                <%= booking.status %>
              </span>
            </td>
            <td>
              <a
                href="/admin/bookings/<%= booking._id %>"
                class="btn btn-sm btn-info"
                >View</a
              >
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</div>
